
<link rel="stylesheet" href="./vis.css">
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>


<div id="vis">
    <audio ref="audio" src="./promo-adam.mp3"></audio>

    <div class="points">
        <div class="point"
             :class="v > 150 ? 'big' : v < 125 ? 'small' : null "
             v-for="v in frequencyData.reverse()"
        >
            {{v}}
        </div>
    </div>
</div>


<script>


    window.$vis = new Vue({
        el: '#vis',
        data() {
            return {
                frequencyData: new Uint8Array(200),
                // show: false
            }
        },

        mounted() {
            var audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            var audioElement = this.$refs.audio
            var audioSrc = audioCtx.createMediaElementSource(audioElement);
            this.analyser = audioCtx.createAnalyser();

            // Bind our analyser to the media element source.
            audioSrc.connect(this.analyser);
            audioSrc.connect(audioCtx.destination);

            this.update()
        },

        methods: {
            update() {
                var data = new Uint8Array(200)
                this.analyser.getByteFrequencyData(data);
                console.log(this.frequencyData)
                this.frequencyData = data
                requestAnimationFrame(() => this.update())
            }
        }
    })
</script>